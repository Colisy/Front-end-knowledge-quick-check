# 可视化埋点

## 需求

将venus上的可视化埋点迁移到melete,之后venus负责后端项目埋点，melete负责前端项目埋点。

## 需求拆分

1. 页面组成，分成俩套页面。一套切换 已上线/回收站，一套切换 表格/详情页。
2. 第一套页面，页面结构分为左右两部分，中间有切分线可以调节左右大小。切分线做成插槽使用，便于其他页面使用。左侧树状结构目录。
3. 第二套页面，由于用到五个表格，还有melete用到大量表格，所以对elementUI表格做了二次封装，便于在melete上使用，以达到配置文件配置好后，引入就能使用。
4. 详情页，分成三部分，可视化埋点/事件信息/页面信息。页面信息支持查看和编辑。事件信息支持查看编辑外还支持展示事件列表。
5. 可视化埋点部分和事件信息交互频繁。可视化埋点点击已埋点，事件信息显示具体内容，可视化埋点点击未埋点，事件信息进入编辑状态。
6. 可视化埋点用的是iframe引入前端页面，然后圈选事件埋点。

## 难点

1. table配置文件，第一项渲染到最后一列。
2. table 切换，表头数据更新错误，切换前的表格数据影响了切换后。用 v-if 对表格进行重新渲染，true 放到微任务里视觉上更快出现，或者可以放到vue 的 $nextTick 里。
3. 页面涉及三种变化，通过路由来进行更替，页面用watch + $route 进行监听获取新数据更新页面。
4. 借用了同事开发的功能，也要尽量减少对同事的依赖，iframe 只用了不得不用的 元素路径/事件ID/查/圈选事件开启，增删改查都自己开发，自己调接口。